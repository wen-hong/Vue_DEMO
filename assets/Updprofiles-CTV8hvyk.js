import{r as u,j as g,c as v,a as e,b,t as d,e as i,v as p,s as x,o as c}from"./index-BxljmCfw.js";import{a as f}from"./api-BQBrDuND.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w={class:"profile-container"},U={class:"avatar-section"},j=["src"],D={class:"upload"},V={class:"form-group"},k={class:"form-group"},C={class:"form-group"},$={class:"form-group"},h=["disabled"],B={__name:"Updprofiles",setup(F){const n=u(!1),t=u({user_name:"",birth:"",sex:null,user_account:""}),r=u(null),s=u("");g(async()=>{const l=await f.get("/profile/me");l.data&&(Object.assign(t.value,l.data),s.value=l.data.avatar_url?`${l.data.avatar_url}?t=${Date.now()}`:"")});const m=l=>{const a=l.target.files[0];a&&(r.value=a,s.value=URL.createObjectURL(a))},_=async()=>{n.value=!0;try{const l=new FormData;l.append("user_name",t.value.user_name),l.append("birth",t.value.birth),t.value.sex!==null&&l.append("sex",t.value.sex),l.append("user_account",t.value.user_account),r.value&&l.append("avatar",r.value);const a=await f.put("/profile/me",l);a.data?.avatar_url&&(s.value=`${a.data.avatar_url}?t=${Date.now()}`),alert("儲存成功"),r.value=null}catch{alert("儲存失敗")}finally{n.value=!1}};return(l,a)=>(c(),v("div",w,[a[8]||(a[8]=e("h2",null,"更新個人資料",-1)),e("div",U,[s.value?(c(),v("img",{key:0,src:s.value,alt:"avatar",class:"avatar"},null,8,j)):b("",!0),e("div",D,[e("input",{type:"file",onChange:m,accept:"image/jpg,image/jpeg,image/png"},null,32)])]),e("div",V,[a[3]||(a[3]=e("label",null,"帳號：",-1)),e("span",null,d(t.value.user_account),1)]),e("div",k,[a[4]||(a[4]=e("label",null,"姓名：",-1)),i(e("input",{"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.user_name=o),placeholder:"請輸入姓名"},null,512),[[p,t.value.user_name]])]),e("div",C,[a[5]||(a[5]=e("label",null,"生日：",-1)),i(e("input",{"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.birth=o),type:"date"},null,512),[[p,t.value.birth]])]),e("div",$,[a[7]||(a[7]=e("label",null,"性別：",-1)),i(e("select",{"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.sex=o)},[...a[6]||(a[6]=[e("option",{value:null},"請選擇",-1),e("option",{value:1},"男",-1),e("option",{value:2},"女",-1)])],512),[[x,t.value.sex]])]),e("button",{class:"save-btn",disabled:n.value,onClick:_},d(n.value?"儲存中...":"儲存"),9,h)]))}},O=y(B,[["__scopeId","data-v-1c3ec34f"]]);export{O as default};
