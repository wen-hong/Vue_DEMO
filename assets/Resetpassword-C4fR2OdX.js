import{e as P,r as l,k as v,c as p,a as s,w as x,d as r,f as y,t as b,h as R,i as h,j as k,o as f,b as q,l as B}from"./index-CKIBwjlQ.js";import{_ as m}from"./PasswordInput-C-5jBNBY.js";import{g as N,P as S,v as C}from"./passwordValidator-Cm378Vfm.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"container"},D={class:"login-card"},L={class:"mb-3"},M={class:"mb-3"},A={class:"mb-3"},E=["disabled"],I={key:0,class:"text-danger text-center mt-3"},O={class:"text-center mt-4"},T={__name:"Resetpassword",setup($){const w=k(),_=P(),u=l(""),a=l(""),d=l(""),t=l(""),n=l(!1),c=v(()=>N(a.value));v(()=>Object.values(c.value).every(Boolean));const g=async()=>{t.value="";const i=C(a.value,d.value,{requireStrong:!0});if(i){t.value=i;return}n.value=!0;try{const e=await B.post("/auth/Resetpassword",{currentPassword:u.value,newPassword:a.value});alert(e.data.message),_.logout(),w.push("/loginbackground/login")}catch(e){t.value=e.response?.data?.error||"更新密碼失敗"}finally{n.value=!1}};return(i,e)=>{const V=h("RouterLink");return f(),p("div",j,[s("div",D,[e[7]||(e[7]=s("h2",{class:"login-title text-center mb-4"},"重設密碼",-1)),s("form",{onSubmit:x(g,["prevent"])},[s("div",L,[e[3]||(e[3]=s("label",{class:"form-label"},"當前密碼",-1)),r(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=o=>u.value=o),placeholder:"輸入當前密碼",required:""},null,8,["modelValue"])]),s("div",M,[e[4]||(e[4]=s("label",{class:"form-label"},"新密碼",-1)),r(m,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value=o),placeholder:"輸入新密碼",required:""},null,8,["modelValue"])]),s("div",A,[e[5]||(e[5]=s("label",{class:"form-label"},"確認新密碼",-1)),r(m,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value=o),placeholder:"再次輸入新密碼",required:""},null,8,["modelValue"])]),r(S,{rules:c.value},null,8,["rules"]),s("button",{type:"submit",class:"btn btn-primary w-100 mt-3",disabled:n.value},b(n.value?"更新中...":"更新密碼"),9,E),t.value?(f(),p("p",I,b(t.value),1)):y("",!0)],32),s("div",O,[r(V,{to:"/"},{default:R(()=>[...e[6]||(e[6]=[q("返回 Dashboard",-1)])]),_:1})])])])}}},J=U(T,[["__scopeId","data-v-7be7d464"]]);export{J as default};
