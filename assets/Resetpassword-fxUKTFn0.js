import{r as l,i as v,c as p,a as s,w as P,d as r,b as x,t as f,f as y,g as R,u as h,o as b,h as k}from"./index-BxljmCfw.js";import{a as q}from"./api-BQBrDuND.js";import{u as B}from"./auth-JwX-xCJt.js";import{_ as m}from"./PasswordInput-BWjFepRa.js";import{P as N,g as S,v as C}from"./passwordValidator-40dcEDL-.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"container"},L={class:"login-card"},M={class:"mb-3"},j={class:"mb-3"},A={class:"mb-3"},E=["disabled"],I={key:0,class:"text-danger text-center mt-3"},O={class:"text-center mt-4"},T={__name:"Resetpassword",setup($){const w=h(),_=B(),n=l(""),a=l(""),d=l(""),o=l(""),u=l(!1),c=v(()=>S(a.value));v(()=>Object.values(c.value).every(Boolean));const g=async()=>{o.value="";const i=C(a.value,d.value,{requireStrong:!0});if(i){o.value=i;return}u.value=!0;try{const e=await q.post("/auth/Resetpassword",{currentPassword:n.value,newPassword:a.value});alert(e.data.message),_.logout(),w.push("/loginbackground/login")}catch(e){o.value=e.response?.data?.error||"更新密碼失敗"}finally{u.value=!1}};return(i,e)=>{const V=R("RouterLink");return b(),p("div",D,[s("div",L,[e[7]||(e[7]=s("h2",{class:"login-title text-center mb-4"},"重設密碼",-1)),s("form",{onSubmit:P(g,["prevent"])},[s("div",M,[e[3]||(e[3]=s("label",{class:"form-label"},"當前密碼",-1)),r(m,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),placeholder:"輸入當前密碼",required:""},null,8,["modelValue"])]),s("div",j,[e[4]||(e[4]=s("label",{class:"form-label"},"新密碼",-1)),r(m,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value=t),placeholder:"輸入新密碼",required:""},null,8,["modelValue"])]),s("div",A,[e[5]||(e[5]=s("label",{class:"form-label"},"確認新密碼",-1)),r(m,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value=t),placeholder:"再次輸入新密碼",required:""},null,8,["modelValue"])]),r(N,{rules:c.value},null,8,["rules"]),s("button",{type:"submit",class:"btn btn-primary w-100 mt-3",disabled:u.value},f(u.value?"更新中...":"更新密碼"),9,E),o.value?(b(),p("p",I,f(o.value),1)):x("",!0)],32),s("div",O,[r(V,{to:"/"},{default:y(()=>[...e[6]||(e[6]=[k("返回 Dashboard",-1)])]),_:1})])])])}}},Q=U(T,[["__scopeId","data-v-7be7d464"]]);export{Q as default};
